# docker-compose.prod.yml (The override file)
services:
  db:
    # Use a different database for isolation or remove if using a managed cloud DB
    environment:
      POSTGRES_DB: app_production # Production DB name
  web:
    # PRODUCTION-SPECIFIC SETTINGS
    volumes: [] # IMPORTANT: Disable volume mounts for production!
    environment:
      RAILS_ENV: production
      # REMOVE hardcoded credentials. Use secrets management (e.g., AWS Secrets, Render Secrets) 
      # or explicitly pass them via the CLI/CI pipeline.
      # EXAMPLE:
      # DATABASE_HOST: <%= ENV['DATABASE_HOST'] %>
      # RAILS_MASTER_KEY: <%= ENV['RAILS_MASTER_KEY'] %> 
    
    # Use the proper production web server command
    command: ["bundle", "exec", "puma", "-C", "config/puma.rb"]